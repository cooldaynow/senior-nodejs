1.4 Фазы eventloop

| **Тип задачи** | **Фаза**            | **Описание**                                                                                              |
|----------------|---------------------|-----------------------------------------------------------------------------------------------------------|
| **Macrotasks** | **Timers**          | Выполнение `setTimeout`, `setInterval`                                                                    |
|                | **I/O Callbacks**   | Выполнение отложенных системных колбэков (например, ошибки `fs`, `dns.lookup`)                            |
|                | **Idle/Prepare**    | Внутренние процессы `libuv`, подготовка к следующему циклу                                                |
|                | **Poll**            | Выполнение колбэков завершённых I/O-операций (`fs.readFile`, `net`, `http` и т.д.)                        |
|                | **Check**           | Выполнение `setImmediate`                                                                                 |
|                | **Close Callbacks** | Выполнение колбэков событий закрытия (`socket.on('close', ...)`, `stream.on('close', ...)`)               |
| **Microtasks** | **Microtask Queue** | Выполнение `Promise.then`, `queueMicrotask`, `process.nextTick` (обрабатываются после каждой макрозадачи) |

Microtasks (`process.nextTick`, `Promise.then`) выполняются **перед переходом** к следующей фазе в `Macrotasks`.

### Что происходит в **I/O Callbacks**?

- Эта фаза предназначена для выполнения **отложенных (deferred) системных колбэков**, которые **не были обработаны в
  Poll**.
- Чаще всего сюда попадают колбэки **сетевых запросов и некоторых системных операций**, например:
    - Ошибки DNS-запросов (если `dns.lookup()` завершается с ошибкой, его колбэк будет исполнен здесь).
    - Обработчики для некоторых типов ошибок файловой системы (например, ошибки в `fs` на Windows).
    - Колбэки некоторых API, не связанных напрямую с I/O Poll, но использующих `libuv`.

### А как же `fs.readFile`, `net`, `http`?

- `fs.readFile`, `http.request`, `net` и другие **обычные I/O-операции** попадают в **Poll**.
- Но если операция была **отменена или завершилась с ошибкой**, её колбэк может исполниться в **I/O Callbacks**.




